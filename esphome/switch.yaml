switch:

  - platform: restart
    name: "${friendly_name} Restart"
    id: reboot 
    internal: true
    icon: "mdi:restart"

  - platform: template
    name: "${friendly_name} firmware update"
    id: fwupdate
    turn_on_action:
      - light.turn_off: blue
      - delay: 1s 
      - switch.turn_on: zigbee_bsl
      - delay: 1s
      - switch.turn_on: zigbee_rst
      - delay: 1s
      - switch.turn_off: zigbee_rst
      - delay: 10s
      - switch.turn_off: zigbee_bsl 
      - light.turn_on: green
      - logger.log: "Please try update with cc-bsl tool now"
      - logger.log: "cc-bsl usage: cc-bsl.py -p socket://ip-of-gw:6638 -evw firmware.hex"
      - logger.log: "please try to write fw on ip:6638, if a error of Timeout waiting for ACK/NACK after 'Synch (0x55 0x55)' repeat with fw update"
      - delay: 10s
      - light.turn_off: green
      - delay: 5s
      - light.turn_on: blue

  - platform: gpio
    id: zigbee_rst
    pin: 15
    name: "Zigbee RST"
    inverted: true
    internal: true
    restore_mode: ALWAYS_OFF

  - platform: gpio
    id: zigbee_bsl
    pin: 22
    name: "Zigbee BSL"
    inverted: False
    internal: true
    restore_mode: ALWAYS_OFF
